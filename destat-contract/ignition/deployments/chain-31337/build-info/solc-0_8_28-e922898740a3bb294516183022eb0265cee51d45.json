{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-e922898740a3bb294516183022eb0265cee51d45",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/SurveyFactory.sol": "project/contracts/SurveyFactory.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": [],
      "viaIR": true
    },
    "sources": {
      "project/contracts/Survey.sol": {
        "content": "// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.28;\r\n\r\nstruct Question {\r\n  string question;\r\n  string[] options;\r\n}\r\n\r\nstruct Answer {\r\n  address respondent;\r\n  uint8[] answers;\r\n}\r\n\r\ncontract Survey {\r\n  string public title;\r\n  string public description;\r\n  uint256 public targetNumber;\r\n  uint256 public rewardAmount;\r\n  Question[] questions; // array의 경우 그 길이가 저장 되기에 slot 하나면 된다\r\n  // Question question; // 하지만, 다음과 같은 Question 타입의 변수는 slot 2개를 요구한다. 당연하게도, Question은 문자열 하나와 문자열 배열을 가지는 struct이기 때문이다.\r\n  Answer[] answers;\r\n  mapping(address => uint) testMap;\r\n\r\n  constructor(\r\n    string memory _title,\r\n    string memory _description,\r\n    uint256 _targetNumber,\r\n    Question[] memory _questions\r\n  ) payable {\r\n    title = _title;\r\n    description = _description;\r\n    targetNumber = _targetNumber;\r\n    rewardAmount = msg.value / _targetNumber;\r\n    testMap[0x8626f6940E2eb28930eFb4CeF49B2d1F2C9C1199] = 1000;\r\n\r\n    for (uint i = 0; i < _questions.length; i++) {\r\n      questions.push(\r\n        Question({\r\n          question: _questions[i].question,\r\n          options: _questions[i].options\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  function getQuestions() external view returns (Question[] memory) {\r\n    return questions;\r\n  }\r\n\r\n  function getAnswers() external view returns (Answer[] memory) {\r\n    return answers;\r\n  }\r\n\r\n  function submitAnswer(Answer calldata _answer) external {\r\n    // length validation\r\n    require(\r\n      _answer.answers.length == questions.length,\r\n      \"Mismatched answers length\"\r\n    );\r\n    require(answers.length < targetNumber, \"This survey has been ended\");\r\n    answers.push(\r\n      Answer({respondent: _answer.respondent, answers: _answer.answers})\r\n    );\r\n    payable(msg.sender).transfer(rewardAmount);\r\n  }\r\n}\r\n"
      },
      "project/contracts/SurveyFactory.sol": {
        "content": "// SPDX-License-Identifier: MIT \r\npragma solidity ^0.8.28;\r\nimport \"./Survey.sol\";\r\n\r\n\r\nstruct SurveyShcema {\r\n    string title;\r\n    string description;\r\n    uint256 targetNumber;\r\n    Question[] questions;\r\n}\r\n\r\nevent SurveyCreated(address);\r\n\r\ncontract SurveyFactory {\r\n    uint256 public min_pool_amount;\r\n    uint256 public min_reward_amount;\r\n    Survey[] surveys; \r\n    //ex pool amount: 50eth, target respondents number: 100, reward: 50 eth / 100 = 0.5eth\r\n\r\n    constructor(uint256 _min_pool_amount, uint256 _min_reward_amount) {\r\n        min_pool_amount = _min_pool_amount; // 설문조사를 시행하는 사람이 넣어야할 최소 금액\r\n        min_reward_amount = _min_reward_amount;\r\n    }\r\n\r\n    function createSurvey(SurveyShcema calldata _survey) external payable{\r\n        require(msg.value >= min_pool_amount, \"Insufficient pool amount\");\r\n        require(msg.value / _survey.targetNumber >= min_reward_amount, \"Insufficient reward amount\");\r\n        Survey survey =  new Survey{value: msg.value}(_survey.title, _survey.description,  _survey.targetNumber, _survey.questions);    \r\n        surveys.push(survey);\r\n        emit SurveyCreated(address(survey));\r\n    }\r\n    \r\n    function getSurveys() external view returns (Survey[] memory){\r\n        return surveys;\r\n    }\r\n}"
      }
    }
  }
}